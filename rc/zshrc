echo "Loading zsh configuration"
echo "..."

# Path to your oh-my-zsh installation.
export ZSH=/Users/$USER/.oh-my-zsh
export DOTFILES_PATH="$HOME/git/me/bag-of-tricks"

# Set name of the theme to load. Optionally, if you set this to "random"
# it'll load a random theme each time that oh-my-zsh is loaded.
# See https://github.com/robbyrussell/oh-my-zsh/wiki/Themes
ZSH_THEME="simple"

source $ZSH/oh-my-zsh.sh
source $DOTFILES_PATH/rc/todo.cfg 
# Custom zsh configuration

alias gcur='echo $(git_current_branch)'
alias todo='todo.sh'
alias vtodo='vim $TODO_FILE'
alias vim='nvim'

# Allows for cd'ing to frequently used directories
# https://thoughtbot.com/blog/cding-to-frequently-used-directories-in-zsh
setopt auto_cd
cdpath=($HOME/git/fabric $HOME/git/me)

# Mimics existing gcn! but without amend
alias gcn='git commit -v --no-edit'

# Base vi mode configuration
# https://dougblack.io/words/zsh-vi-mode.html

bindkey -v

bindkey '^P' up-history
bindkey '^N' down-history
bindkey '^?' backward-delete-char
bindkey '^h' backward-delete-char
bindkey '^w' backward-kill-word
bindkey '^r' history-incremental-search-backward

# Override cursor behavior to detect mode
# http://lynnard.me/blog/2014/01/05/change-cursor-shape-for-zsh-vi-mode/

function zle-keymap-select {
    if [ "$TERM" = "xterm-256color" ]; then
        if [ $KEYMAP = vicmd ]; then
            # the command mode for vi
            echo -ne "\e[2 q"
        else
            # the insert mode for vi
            echo -ne "\e[4 q"
        fi
    fi
}

zle -N zle-keymap-select
export KEYTIMEOUT=1

# Bash configuration

source ~/.bashrc

# Zsh execution of bash prompt helper
# @see https://spin.atomicobject.com/2016/05/28/log-bash-history/
# @see https://superuser.com/questions/735660/whats-the-zsh-equivalent-of-bashs-prompt-command
prmptcmd() { eval "$PROMPT_COMMAND" }
precmd_functions=(prmptcmd)

echo "Successfully loaded zsh configuration"
echo "..."
